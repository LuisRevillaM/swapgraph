# M18 â€” CycleProposal read APIs fixture scenario (list/get) + authz proofs

## Objective
Make `CycleProposal` read endpoints verifiable (fixtures-first) for:
- `GET /cycle-proposals` (list)
- `GET /cycle-proposals/{id}` (get)

This milestone proves:
- response bodies validate against the API manifest response schemas
- authz rules are explicit and enforced (via fixtures)

## Rules (v1)
### Actors
- `partner`
  - Can **list** proposals scoped to their `partner_id`.
  - Can **get** a proposal **only if** it is scoped to their `partner_id`.
- `user`
  - Can **list** proposals where they are a participant.
  - Can **get** a proposal **only if** they are a participant.
- `agent`
  - Forbidden (delegation comes later).

### Scoping model (fixtures-only)
- Proposal scoping is represented as:
  - `store.state.tenancy.proposals[proposal_id] = { partner_id }`

### Error codes
- `NOT_FOUND` when the proposal does not exist.
- `FORBIDDEN` when it exists but the actor is not authorized.

## Scope
- Seed proposals from `fixtures/matching/m5_expected.json`.
- Execute a scenario that exercises list/get across partner/user/agent actors.
- Validate:
  - success responses against schemas from `docs/spec/api/manifest.v1.json`
  - error responses against `docs/spec/schemas/ErrorResponse.schema.json`

## Acceptance criteria
- `npm run verify:m18` exits 0.
- `node verify/runner.ts milestones/M18.yaml` exits 0.

## Required artifacts
- `docs/prd/M18.md`
- `fixtures/proposals/m18_scenario.json`
- `fixtures/proposals/m18_expected.json`
- `src/read/cycleProposalsReadService.mjs`
- `scripts/run-m18-cycle-proposals-read-scenario.mjs`
- Proof outputs under `artifacts/milestones/M18/latest/*`
