# M118 â€” Matching v2 shadow observability burn-in gate

## Objective
Define and enforce a deterministic burn-in gate for matching v2 shadow mode so cutover planning can be driven by explicit KPI thresholds instead of ad-hoc inspection.

## Scope
- Keep v1 as the only authoritative proposal writer.
- Keep v2 in shadow-only execution.
- Add a burn-in verifier scenario that measures shadow KPI signals and enforces pass/fail thresholds.
- Cover both:
  - healthy shadow run expectations, and
  - forced shadow-failure fallback expectations.
- Emit deterministic proof artifacts for gate evaluation.

## KPI gate (M118)
Per burn-in case, evaluate:
- shadow record coverage (`min_shadow_records`),
- shadow error rate (`max_shadow_error_rate_bps`),
- timeout rate (`max_timeout_rate_bps`),
- cycle-limit saturation rate (`max_limited_rate_bps`),
- cycle-gain rate (`min_cycle_gain_rate_bps`),
- non-negative delta-score rate (`min_non_negative_delta_rate_bps`),
- v2 runtime p95 bound (`max_v2_runtime_p95_ms`).

## Non-goals (M118)
- No v2 primary cutover.
- No marketplace API schema changes.
- No settlement/auth harness changes.
- No TypeScript runtime migration.

## Acceptance criteria
- `npm run verify:m118` exits 0.
- `npm run verify:m117:local` exits 0 (shadow baseline parity remains intact).
- Deterministic proof artifacts exist at `artifacts/milestones/M118/latest/*`.

## Required artifacts
- `scripts/run-m118-shadow-burnin-gate-scenario.mjs`
- `fixtures/release/m118_scenario.json`
- `fixtures/release/m118_expected.json`
- `verify/m118.sh`
- `milestones/M118.yaml`
- `artifacts/milestones/M118/latest/matching_v2_shadow_burnin_output.json`
- `artifacts/milestones/M118/latest/assertions.json`
- `artifacts/milestones/M118/latest/commands.log`
