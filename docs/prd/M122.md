# M122 â€” TypeScript matching module migration phase 1 (parity-gated, non-breaking)

## Objective
Start real module-by-module TypeScript migration for matching core by replacing wrapper-only shadow modules with concrete `.mts` implementations while preserving runtime behavior contracts.

## Scope
- Replace `src-ts/matching/assetKeys.mts` wrapper with concrete module implementation.
- Replace `src-ts/matching/wantSpec.mts` wrapper with concrete module implementation.
- Add deterministic migration parity scenario and verifier for these modules:
  - no `export *` wrapper indirection
  - exported function surface parity
  - normalized logic parity hash equality against source `.mjs` modules
- Compose dependency gate from:
  - `npm run verify:m5`
  - `npm run verify:m111`
  - `npm run verify:m114`

## Non-goals (M122)
- No runtime cutover to execute `.mts` modules in API runtime.
- No matcher algorithm changes.
- No API schema or manifest changes.
- No expansion to additional matching modules in this milestone.

## Acceptance criteria
- `npm run verify:m122` exits 0.
- `npm run verify:m5` exits 0.
- `npm run verify:m111` exits 0.
- `npm run verify:m114` exits 0.
- Deterministic proof artifacts exist at `artifacts/milestones/M122/latest/*`.

## Required artifacts
- `docs/prd/M122.md`
- `src-ts/matching/assetKeys.mts`
- `src-ts/matching/wantSpec.mts`
- `scripts/run-m122-typescript-matching-module-parity-scenario.mjs`
- `fixtures/release/m122_scenario.json`
- `fixtures/release/m122_expected.json`
- `verify/m122.sh`
- `milestones/M122.yaml`
- `artifacts/milestones/M122/latest/typescript_matching_module_parity_output.json`
- `artifacts/milestones/M122/latest/assertions.json`
- `artifacts/milestones/M122/latest/commands.log`
