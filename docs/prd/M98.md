# M98 — API + event surface completion contracts (PRD-only, implementation-ready)

## Objective
Close remaining v2 illustrative API/event coverage gaps as explicit, deterministic contracts before new feature expansion.

## Scope
### A) API contract inventory (to define)
1. **Platform connections**
   - `platform.connections.list` → `GET /platform-connections`
   - `platform.connections.upsert` → `POST /platform-connections`
2. **Inventory surfaces**
   - `inventory.snapshots.record` → `POST /inventory/snapshots`
   - `inventory.assets.list` → `GET /inventory/assets`
3. **Disputes facade**
   - `disputes.create` → `POST /disputes`
   - `disputes.get` → `GET /disputes/{dispute_id}`

### B) Event contract inventory (to define)
- `proposal.cancelled`
- `cycle.failed`
- `user.reliability_changed`

### C) Contract requirements
- Schema definitions + examples + manifest entries.
- Auth scope requirements and allowed actor types per operation.
- Idempotency semantics for all mutating operations.
- Deterministic error reason-code matrix.
- Verifier scenario design requirements (for future implementation milestone execution).

## Proposed schema artifacts (naming target)
- `PlatformConnection*.schema.json`
- `InventorySnapshot*.schema.json`
- `InventoryAssetListResponse.schema.json`
- `Dispute*.schema.json` facade schemas
- `ProposalCancelledPayload.schema.json`
- `CycleFailedPayload.schema.json`
- `UserReliabilityChangedPayload.schema.json`

## Non-goals (M98)
- No UI/client implementation.
- No live partner OAuth callback implementation details beyond contract definitions.
- No changes to settlement execution behavior.

## Open decisions to resolve in PRD review
1. Scope model: reuse existing scopes vs introduce dedicated `platform_connections:*`, `inventory:*`, `disputes:*` scopes.
2. Canonical dispute facade mapping to existing partner dispute workflows (avoid duplicate semantic pathways).
3. Event ordering guarantees for newly introduced event types.

## Acceptance (PRD stage)
- M98 PRD is accepted when the API/event contract inventory is fully enumerated with non-overlapping operation IDs and payload types, and all open decisions have owners + resolution path.

## Acceptance (future implementation stage)
- `npm run verify:m98` exits 0.
- `node verify/runner.ts milestones/M98.yaml` returns `overall=true`.
- Artifacts under `artifacts/milestones/M98/latest/*`.
