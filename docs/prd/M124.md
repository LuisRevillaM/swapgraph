# M124 â€” TypeScript matching module migration phase 3 (parity-gated, non-breaking)

## Objective
Complete concrete TypeScript migration for matching-core execution path by replacing wrapper-only shadow modules for cycle enumeration, compatibility graph construction, and engine orchestration while preserving behavior contracts.

## Scope
- Replace `src-ts/matching/cycles.mts` wrapper with concrete module implementation.
- Replace `src-ts/matching/graph.mts` wrapper with concrete module implementation.
- Replace `src-ts/matching/engine.mts` wrapper with concrete module implementation.
- Add deterministic parity scenario/verifier for this tranche:
  - no `export *` wrapper indirection on migrated modules
  - exported function surface parity
  - normalized logic parity hash equality against source `.mjs` modules
- Compose dependency gate from `npm run verify:m123`.

## Non-goals (M124)
- No runtime cutover to execute `.mts` modules in API runtime.
- No matcher algorithm changes.
- No API/schema/manifest changes.
- No migration of marketplace service/store modules in this milestone.

## Acceptance criteria
- `npm run verify:m124` exits 0.
- `npm run verify:m123` exits 0 (composed dependency gate).
- Deterministic proof artifacts exist at `artifacts/milestones/M124/latest/*`.

## Required artifacts
- `docs/prd/M124.md`
- `src-ts/matching/cycles.mts`
- `src-ts/matching/graph.mts`
- `src-ts/matching/engine.mts`
- `scripts/run-m124-typescript-matching-module-parity-phase3-scenario.mjs`
- `fixtures/release/m124_scenario.json`
- `fixtures/release/m124_expected.json`
- `verify/m124.sh`
- `milestones/M124.yaml`
- `artifacts/milestones/M124/latest/typescript_matching_module_parity_phase3_output.json`
- `artifacts/milestones/M124/latest/assertions.json`
- `artifacts/milestones/M124/latest/commands.log`
