# M106 — House LP listing and proposal participation contracts (implemented, fixtures-first)

Status: Implemented and verifier-closed on 2026-02-22 (`npm run verify:m106`, `node verify/runner.mjs milestones/M106.yaml`).

## Objective
Define deterministic contract paths for house LPs to publish listings and participate in proposal decisions with explicit explainability payloads and auditable lineage.

## Why this is required (integration findings)
- Existing proposal accept/decline surfaces are user-centric.
- LP participation cannot rely on hidden internal shortcuts.
- Strategy credibility depends on deterministic “why accepted/declined” lineage.

## Scope
### A) LP listing generation contracts (implemented)
1. `liquidityListings.upsert` → `POST /liquidity-providers/{provider_id}/listings`
2. `liquidityListings.cancel` → `POST /liquidity-providers/{provider_id}/listings/{intent_id}/cancel`
3. `liquidityListings.list` → `GET /liquidity-providers/{provider_id}/listings`

### B) LP proposal decision contracts (implemented)
1. `liquidityDecisions.proposal.accept` → `POST /liquidity-providers/{provider_id}/proposals/{proposal_id}/accept`
2. `liquidityDecisions.proposal.decline` → `POST /liquidity-providers/{provider_id}/proposals/{proposal_id}/decline`
3. `liquidityDecisions.get` → `GET /liquidity-providers/{provider_id}/decisions/{decision_id}`

### C) Decision explanation requirements (enforced)
- Every LP decision requires:
  - `decision_reason_codes[]`
  - `policy_ref`
  - `confidence_score_bps`
  - `risk_tier_snapshot`
  - `correlation_id`
- Decision records include deterministic intent/proposal/commit lineage.

## Contract constraints
- LP actions are idempotent and replay-safe.
- Decision idempotency scope binds `provider_id + operation_id + proposal_id + idempotency_key`.
- LP decisions cannot bypass trust/safety outcomes; decisions are denied without an `allow` trust/safety gate.
- Listing/decision writes and reads preserve deterministic reason-code taxonomy.

## Implemented schema artifacts
- `LiquidityListingView.schema.json`
- `LiquidityListingUpsertRequest.schema.json`
- `LiquidityListingUpsertResponse.schema.json`
- `LiquidityListingCancelRequest.schema.json`
- `LiquidityListingCancelResponse.schema.json`
- `LiquidityListingListResponse.schema.json`
- `LiquidityDecisionView.schema.json`
- `LiquidityProposalDecisionAcceptRequest.schema.json`
- `LiquidityProposalDecisionAcceptResponse.schema.json`
- `LiquidityProposalDecisionDeclineRequest.schema.json`
- `LiquidityProposalDecisionDeclineResponse.schema.json`
- `LiquidityDecisionGetResponse.schema.json`

## Event additions (implemented)
- `liquidity.listing.published`
- `liquidity.decision.recorded`

## Deterministic reason-code floor (enforced)
- `liquidity_listing_invalid`
- `liquidity_listing_policy_violation`
- `liquidity_listing_not_found`
- `liquidity_decision_invalid`
- `liquidity_decision_policy_missing`
- `liquidity_decision_not_found`

## Non-goals (M106)
- No autonomous execution rollout.
- No UI implementation for persona pages.
- No partner LP onboarding/governance rollout (later milestones).

## Acceptance (implementation stage)
- `npm run verify:m106` exits 0.
- `node verify/runner.mjs milestones/M106.yaml` returns `overall=true`.
- Artifacts under `artifacts/milestones/M106/latest/*`.
