# M126 â€” TypeScript service helper extraction parity gate (non-breaking)

## Objective
Extract pure marketplace matching service helpers into dedicated modules and establish deterministic parity between JS runtime helper code and TS service-helper implementation.

## Scope
- Add extracted JS helper module:
  - `src/service/marketplaceMatchingHelpers.mjs`
- Add concrete TS parity module:
  - `src-ts/service/marketplaceMatchingHelpers.mts`
- Wire runtime service to use extracted JS helper module without behavior changes:
  - `src/service/marketplaceMatchingService.mjs`
- Add deterministic parity + extraction contract scenario/verifier:
  - `scripts/run-m126-typescript-service-helper-parity-scenario.mjs`
  - `fixtures/release/m126_scenario.json`
  - `fixtures/release/m126_expected.json`
  - `verify/m126.sh`
  - `milestones/M126.yaml`

## Non-goals (M126)
- No API/schema changes.
- No runtime cutover to TS service execution.
- No matcher algorithm or policy behavior changes.
- No service-class migration beyond helper extraction.

## Acceptance criteria
- `npm run verify:m126` exits 0.
- `npm run verify:m125` exits 0 (composed dependency gate).
- `npm run verify:m121` exits 0 (TS scaffold compatibility gate).
- Verifier asserts:
  - TS helper module is concrete (no wrapper `export *` indirection).
  - JS/TS helper export surfaces match expected function set.
  - Normalized parity hash matches between helper implementations.
  - extracted helper functions are imported into `marketplaceMatchingService` and no longer locally defined there.

## Required artifacts
- `docs/prd/M126.md`
- `src/service/marketplaceMatchingHelpers.mjs`
- `src-ts/service/marketplaceMatchingHelpers.mts`
- `src/service/marketplaceMatchingService.mjs`
- `scripts/run-m126-typescript-service-helper-parity-scenario.mjs`
- `fixtures/release/m126_scenario.json`
- `fixtures/release/m126_expected.json`
- `verify/m126.sh`
- `milestones/M126.yaml`
- `artifacts/milestones/M126/latest/typescript_service_helper_parity_output.json`
- `artifacts/milestones/M126/latest/assertions.json`
- `artifacts/milestones/M126/latest/commands.log`
