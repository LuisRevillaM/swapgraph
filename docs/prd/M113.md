# M113 â€” Render deployment smoke hardening automation (integration-gated)

Status: In progress (automation implemented; live integration execution pending credentials).

## Objective
Automate deployment smoke hardening on Render so runtime operability checks are repeatable and script-driven instead of manual dashboard workflows.

## Scope
1. Render API orchestration script:
   - reuse or create service,
   - ensure persistent disk,
   - enforce runtime env vars (`STATE_BACKEND=sqlite`, `STATE_FILE=...`),
   - trigger deploy and poll to `live`,
   - restart service and verify post-restart health.
2. Live smoke checks against deployed URL:
   - `GET /healthz` backend/persistence diagnostics,
   - `swap-intents` write/read path,
   - `marketplaceMatching.run` and `marketplaceMatchingRun.get`.
3. Integration-gated verifier shell + milestone descriptor + artifact capture.

## Integration gate requirements
- `INTEGRATION_ENABLED=1`
- `RENDER_API_KEY` (required)
- plus Render config env as needed for create/reuse flow:
  - `RENDER_SERVICE_ID` (reuse existing) or
  - `RENDER_SERVICE_NAME` + `RENDER_OWNER_ID` (+ `RENDER_REPO_URL` when create path is needed)

## Non-goals (M113)
- No load/performance testing.
- No multi-instance SQLite topology.
- No destructive disk snapshot restore by default.

## Acceptance
M113 is accepted when:
1. automated script can deploy/redeploy and pass health + smoke checks,
2. restart durability is confirmed in live environment,
3. verifier artifacts are captured under `artifacts/milestones/M113/latest/*`.
