# M123 â€” TypeScript matching module migration phase 2 (parity-gated, non-breaking)

## Objective
Continue real module-by-module TypeScript migration in matching core by replacing wrapper-only shadow modules for scoring/value/proposal synthesis with concrete `.mts` implementations while preserving behavior contracts.

## Scope
- Replace `src-ts/matching/values.mts` wrapper with concrete module implementation.
- Replace `src-ts/matching/scoring.mts` wrapper with concrete module implementation.
- Replace `src-ts/matching/proposals.mts` wrapper with concrete module implementation.
- Add deterministic parity scenario/verifier for this tranche:
  - no `export *` wrapper indirection on migrated modules
  - exported function surface parity
  - normalized logic parity hash equality against source `.mjs` modules
- Compose dependency gate from `npm run verify:m122`.

## Non-goals (M123)
- No runtime cutover to execute `.mts` modules in API runtime.
- No matcher algorithm changes.
- No API/schema/manifest changes.
- No migration of `cycles`/`graph`/`engine` modules in this milestone.

## Acceptance criteria
- `npm run verify:m123` exits 0.
- `npm run verify:m122` exits 0 (composed dependency gate).
- Deterministic proof artifacts exist at `artifacts/milestones/M123/latest/*`.

## Required artifacts
- `docs/prd/M123.md`
- `src-ts/matching/values.mts`
- `src-ts/matching/scoring.mts`
- `src-ts/matching/proposals.mts`
- `scripts/run-m123-typescript-matching-module-parity-phase2-scenario.mjs`
- `fixtures/release/m123_scenario.json`
- `fixtures/release/m123_expected.json`
- `verify/m123.sh`
- `milestones/M123.yaml`
- `artifacts/milestones/M123/latest/typescript_matching_module_parity_phase2_output.json`
- `artifacts/milestones/M123/latest/assertions.json`
- `artifacts/milestones/M123/latest/commands.log`
