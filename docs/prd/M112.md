# M112 â€” Storage hardening and SQLite migration path (planned)

Status: Planned (not yet implemented).

## Objective
Harden persistence for deployable environments by introducing a migration-safe storage backend path for runtime state, with SQLite as the first durable target and no contract regressions.

## Scope (planned)
### A) Storage backend abstraction
1. Introduce a runtime store selector (`json` vs `sqlite`) with explicit config.
2. Preserve existing service-level store semantics so API contracts remain unchanged.
3. Keep deterministic canonical serialization semantics for verifier artifacts.

### B) SQLite backend activation path
1. Add a SQLite-backed state store implementation with atomic write semantics.
2. Add bootstrap and migration scripts for JSON-state import into SQLite.
3. Add health diagnostics exposing active storage backend and persistence mode.

### C) Safety and operability gates
1. Crash/restart durability checks for runtime API state.
2. Backup/restore contract for deployment operators.
3. Deployment runbook updates for Render-style ephemeral filesystem constraints.

## Non-goals (M112)
- No API contract shape changes.
- No matching heuristic changes.
- No UI implementation work in this milestone.

## Acceptance target (planned)
M112 will be accepted when:
1. runtime can run with SQLite backend and preserve state across restarts,
2. contract verifiers remain green with no API/auth/schema regressions,
3. migration tooling can import existing JSON state deterministically,
4. deployment docs/runbooks reflect the new persistence posture.
