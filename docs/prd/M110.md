# M110 — Swarm transparency and user-control contracts (implemented, fixtures-first)

Status: Implemented and verifier-closed on 2026-02-22 (`npm run verify:m110`, `node verify/runner.mjs milestones/M110.yaml`).

## Objective
Define and enforce product-facing transparency and user-control contracts required for a trustworthy LP subsystem (explicit LP labels, opt-out controls, and explainable counterparties).

## Scope
### A) Transparency directory contracts
1. `liquidityDirectory.list` → `GET /liquidity-providers/directory`
2. `liquidityDirectory.get` → `GET /liquidity-providers/directory/{provider_id}`
3. `liquidityDirectory.persona.list` → `GET /liquidity-providers/directory/{provider_id}/personas`

### B) User-control contracts
1. `counterpartyPreferences.get` → `GET /counterparty-preferences`
2. `counterpartyPreferences.upsert` → `POST /counterparty-preferences`
   - controls floor:
     - `allow_bots`
     - `allow_house_liquidity`
     - `allow_partner_lp`
     - category-level counterparty filters

### C) Projection contracts
1. `proposalCounterpartyDisclosure.get` → `GET /product-projections/proposals/{proposal_id}/counterparty-disclosure`
2. `receiptCounterpartyDisclosure.get` → `GET /product-projections/receipts/{receipt_id}/counterparty-disclosure`

### D) UX safety requirements
- Any LP counterparty is explicitly labeled.
- No LP activity is represented as human activity without disclosure.
- Users can opt out of LP counterparties with deterministic no-match signaling when constraints remove all eligible paths.

## Upstream dependencies
- M101 product projection contracts.
- M103 LP attribution primitives.
- M106/M108 decision explanation lineage.

## Deterministic reason-code floor
- `counterparty_preferences_invalid`
- `counterparty_preferences_invalid_timestamp`
- `counterparty_preferences_conflict`
- `liquidity_directory_query_invalid`
- `counterparty_disclosure_not_found`

## Non-goals (M110)
- No web/iOS client implementation.
- No notification-delivery implementation changes.
- No recommendation-ranking implementation in this milestone.

## Acceptance
M110 is accepted when:
1. transparency directory and user-control operations are explicit and implemented,
2. disclosure requirements are explicit and non-ambiguous,
3. projection contracts for proposal/receipt transparency are implemented,
4. deterministic reason-code floor is enforced and verifier-covered.

## Implementation closure gate (M110)
M110 implementation closure is achieved when:
- `npm run verify:m110` exits 0.
- `node verify/runner.mjs milestones/M110.yaml` returns `overall=true`.
- Artifacts are present under `artifacts/milestones/M110/latest/*`.
