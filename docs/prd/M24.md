# M24 — End-to-end store-backed pipeline smoke test (delivery → commit → settlement → reads)

## Objective
Prove the **happy-path** works end-to-end using only **store-backed services** (no injected proposal/timeline objects):

1) **Delivery ingestion** stores proposals + partner scoping.
2) **Commit** endpoints accept those stored proposals.
3) **Settlement** starts and completes for that cycle.
4) **Read endpoints** return schema-valid responses (including `correlation_id`) and enforce authz.

This remains **fixtures-first** (no HTTP server).

## Inputs
- Delivery fixture output: `fixtures/delivery/m6_expected.json` (webhook `proposal.created` events)
- Matching fixture input: `fixtures/matching/m5_input.json` (intents)

## Rules (v1)
- Delivery ingestion: partner-only, dedupe by `event_id`.
- Commit: participants-only, idempotent.
- Settlement start/execute/complete: owning partner-only (scoped via tenancy).
- Reads:
  - partner can read their own cycles
  - participant users can read
  - outsiders are forbidden

## Acceptance criteria
- `npm run verify:m24` exits 0.
- `node verify/runner.mjs milestones/M24.yaml` exits 0.

## Required artifacts
- `docs/prd/M24.md`
- `fixtures/pipeline/m24_scenario.json`
- `fixtures/pipeline/m24_expected.json`
- `scripts/run-m24-e2e-pipeline-scenario.mjs`
- Proof outputs under `artifacts/milestones/M24/latest/*`
