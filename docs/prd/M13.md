# M13 — Settlement read APIs fixture scenario (instructions/status/receipts)

## Objective
Prove the **read-side REST contract** for settlement and receipts using deterministic fixtures.

This milestone is still **spec/contract-first**:
- no HTTP server
- no Steam integration
- just schema-valid response objects generated from store state + verified against the API manifest

## Scope
Implement a fixtures-first scenario that:
1. drives the store into realistic settlement states (using the existing simulator), then
2. produces read endpoint responses and validates them against the schemas declared in `docs/spec/api/manifest.v1.json`.

Read endpoints under test:
- `GET /settlement/{cycle_id}/instructions` → `SettlementInstructionsGetResponse`
- `GET /settlement/{cycle_id}/status` → `SettlementStatusGetResponse`
- `GET /receipts/{cycle_id}` → `SwapReceiptGetResponse`

Behavior expectations (v1)
- Instructions are derived from `SettlementTimeline` legs and should be deterministic.
- Status returns the current `SettlementTimeline`.
- Receipts endpoint returns:
  - `NOT_FOUND` until a receipt exists
  - a schema-valid `SwapReceipt` after completion/failure

## Acceptance criteria
- `npm run verify:m13` exits 0.
- `node verify/runner.mjs milestones/M13.yaml` exits 0.

## Required artifacts
Fixtures:
- `fixtures/settlement/m13_scenario.json`
- `fixtures/settlement/m13_expected.json`

Proof artifacts:
- `artifacts/milestones/M13/latest/settlement_read_output.json`
- `artifacts/milestones/M13/latest/assertions.json`
- `artifacts/milestones/M13/latest/commands.log`
