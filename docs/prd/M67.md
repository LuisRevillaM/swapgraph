# M67 â€” Rollout diagnostics automation expected-effect projections (fixtures-first)

## Objective
Finalize deterministic automation-execution planning by adding signed, per-step expected policy-control effects to diagnostics automation action requests.

## Scope

### 1) Expected-effect projections on action requests
Extend `automation_hints.action_requests[]` with signed `expected_effect`:
- `policy_version_after`
- `maintenance_mode_enabled`
- `freeze_until`
- `freeze_active`

Projections must be deterministic and sequentially derived from current policy controls plus ordered action templates.

### 2) Plan-hash coverage
Ensure `expected_effect` is part of the canonical automation plan payload covered by:
- per-export `export_hash`
- `automation_hints.plan_hash`
- signature verification paths

### 3) Contract/docs updates
Update diagnostics schema/examples/API text to include `expected_effect` semantics.

### 4) Fixtures-first verifier
Scenario proves:
- max-actions=1 and max-actions=2 include deterministic expected-effect chains
- continuation exports preserve expected-effect + plan-hash integrity
- clear-controls/no-action state returns empty expected-effect arrays with valid plan hash
- existing guardrails remain deterministic
- tamper-fail checks remain enforced

## Acceptance criteria
- `npm run verify:m67` exits 0.
- `node verify/runner.mjs milestones/M67.yaml` returns `overall=true`.
- artifacts exist under `artifacts/milestones/M67/latest/*`.
