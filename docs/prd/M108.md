# M108 — LP autonomy policy, decision audit, and anti-farming controls (PRD-only, implementation-ready)

## Objective
Define deterministic LP autonomy-policy contracts so automated LP decisions are bounded by risk controls, explainable logic, and tamper-evident audit exports.

## Why this is required (integration findings)
- Existing risk-tier and trust/safety contracts exist but are not LP-specific.
- LP market-maker behavior is exploitable without anti-farming controls.
- We need auditable “why accepted/declined” records for user and support trust.

## Scope
### A) LP policy contracts (to define)
1. `liquidityPolicy.upsert` → `POST /liquidity-providers/{provider_id}/policies`
2. `liquidityPolicy.get` → `GET /liquidity-providers/{provider_id}/policies`
3. `liquidityPolicy.evaluate` → `POST /liquidity-providers/{provider_id}/policies/evaluate`

### B) Anti-farming and exposure controls (minimum)
- `max_spread_bps`
- `max_daily_value_usd`
- `max_counterparty_exposure_usd`
- `min_price_confidence_bps`
- `blocked_asset_liquidity_tiers[]`
- `high_volatility_mode` behavior (`tighten|pause|quote_only`)

### C) Decision audit/export contracts (to define)
1. `liquidityDecision.audit.list` → `GET /liquidity-providers/{provider_id}/decision-audit`
2. `liquidityDecision.audit.export` → `GET /liquidity-providers/{provider_id}/decision-audit/export`

## Contract constraints
- Evaluation must produce deterministic verdicts for equivalent policy+input.
- Policy outcomes must honor trust/safety precedence.
- Audit/export surfaces require signed continuity and tamper-fail verification.

## Proposed schema artifacts (naming target)
- `LiquidityPolicyUpsertRequest.schema.json`
- `LiquidityPolicyUpsertResponse.schema.json`
- `LiquidityPolicyGetResponse.schema.json`
- `LiquidityPolicyEvaluateRequest.schema.json`
- `LiquidityPolicyEvaluateResponse.schema.json`
- `LiquidityDecisionAuditListResponse.schema.json`
- `LiquidityDecisionAuditExportResponse.schema.json`

## Deterministic reason-code floor (proposed)
- `liquidity_policy_invalid`
- `liquidity_policy_precedence_violation`
- `liquidity_policy_spread_exceeded`
- `liquidity_policy_exposure_exceeded`
- `liquidity_policy_price_confidence_low`
- `liquidity_policy_high_volatility_pause`
- `liquidity_decision_audit_query_invalid`

## Non-goals (M108)
- No model-training implementation.
- No discretionary manual-review tooling UX.
- No partner monetization implementation changes.

## Acceptance (PRD stage)
M108 is accepted when:
1. policy objects and evaluation semantics are explicit,
2. anti-farming control floor is explicit,
3. audit/export boundaries are explicit,
4. deterministic reason-code floor is approved.

## Acceptance (future implementation stage)
- `npm run verify:m108` exits 0.
- `node verify/runner.ts milestones/M108.yaml` returns `overall=true`.
- Artifacts under `artifacts/milestones/M108/latest/*`.
