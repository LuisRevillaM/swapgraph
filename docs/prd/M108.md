# M108 — LP autonomy policy, decision audit, and anti-farming controls (implemented, fixtures-first)

Status: Implemented and verifier-closed on 2026-02-22 (`npm run verify:m108`, `node verify/runner.mjs milestones/M108.yaml`).

## Objective
Define deterministic LP autonomy-policy contracts so automated LP decisions are bounded by risk controls, explainable logic, and tamper-evident audit exports.

## Why this is required (integration findings)
- Existing risk-tier and trust/safety contracts exist but are not LP-specific.
- LP market-maker behavior is exploitable without anti-farming controls.
- We need auditable “why accepted/declined” records for user and support trust.

## Scope
### A) LP policy contracts (implemented)
1. `liquidityPolicy.upsert` → `POST /liquidity-providers/{provider_id}/policies`
2. `liquidityPolicy.get` → `GET /liquidity-providers/{provider_id}/policies`
3. `liquidityPolicy.evaluate` → `POST /liquidity-providers/{provider_id}/policies/evaluate`

### B) Anti-farming and exposure controls (enforced)
- `max_spread_bps`
- `max_daily_value_usd`
- `max_counterparty_exposure_usd`
- `min_price_confidence_bps`
- `blocked_asset_liquidity_tiers[]`
- `high_volatility_mode` behavior (`tighten|pause|quote_only`)

### C) Decision audit/export contracts (implemented)
1. `liquidityDecision.audit.list` → `GET /liquidity-providers/{provider_id}/decision-audit`
2. `liquidityDecision.audit.export` → `GET /liquidity-providers/{provider_id}/decision-audit/export`

## Contract constraints
- Evaluation is deterministic and idempotent.
- Policy outcomes enforce precedence: `safety>trust>lp_autonomy_policy>commercial>preference`.
- Audit export includes signed attestation/checkpoint continuity.
- Retention and redaction hooks are enforced on export/list query paths.

## Implemented schema artifacts
- `LiquidityAutonomyPolicyView.schema.json`
- `LiquidityPolicyUpsertRequest.schema.json`
- `LiquidityPolicyUpsertResponse.schema.json`
- `LiquidityPolicyGetResponse.schema.json`
- `LiquidityPolicyEvaluateRequest.schema.json`
- `LiquidityPolicyEvaluateResponse.schema.json`
- `LiquidityDecisionAuditEntry.schema.json`
- `LiquidityDecisionAuditListResponse.schema.json`
- `LiquidityDecisionAuditExportResponse.schema.json`

## Deterministic reason-code floor (enforced)
- `liquidity_policy_invalid`
- `liquidity_policy_precedence_violation`
- `liquidity_policy_spread_exceeded`
- `liquidity_policy_exposure_exceeded`
- `liquidity_policy_price_confidence_low`
- `liquidity_policy_high_volatility_pause`
- `liquidity_decision_audit_query_invalid`

## Non-goals (M108)
- No model-training implementation.
- No discretionary manual-review tooling UX.
- No partner monetization implementation changes.

## Acceptance (implementation stage)
- `npm run verify:m108` exits 0.
- `node verify/runner.mjs milestones/M108.yaml` returns `overall=true`.
- Artifacts under `artifacts/milestones/M108/latest/*`.
